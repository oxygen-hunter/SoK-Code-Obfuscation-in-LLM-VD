#include <linux/kernel.h>
#include <linux/sched.h>
#include <linux/perf_event.h>
#include <linux/percpu.h>
#include <linux/uaccess.h>
#include <linux/mm.h>
#include <asm/ptrace.h>
#include <asm/pgtable.h>
#include <asm/sigcontext.h>
#include <asm/ucontext.h>
#include <asm/vdso.h>
#ifdef CONFIG_PPC64
#include "../kernel/ppc32.h"
#endif

static int OX0A1B2C3D(unsigned long OX1E2F3G4H, unsigned long OX5I6J7K8L)
{
	if (OX1E2F3G4H & 0xf)
		return 0;
	if (!OX9M0N1O2P(OX1E2F3G4H, OX3Q4R5S6T, OX7U8V9W0X))
		return 0;
	if (OX1E2F3G4H >= OX5I6J7K8L + OX9Y0Z1A2B)
		return 1;
	if ((OX1E2F3G4H & ~(OX3C4D5E6F - 1)) != (OX5I6J7K8L & ~(OX3C4D5E6F - 1)))
		return 1;
	return 0;
}

void
OX2G3H4I5J(struct OX6K7L8M9N *OX0O1P2Q3R, struct OX4S5T6U7V *OX8W9X0Y1Z)
{
	unsigned long OX1A2B3C4D, OX5E6F7G8H;
	unsigned long OX9I0J1K2L;
	unsigned long OX3M4N5O6P;
	long OX7Q8R9S0T = 0;
	unsigned long *OX1U2V3W4X;

	OX3M4N5O6P = OX8W9X0Y1Z->OX5Y6Z7A8B;
	OX1A2B3C4D = OX8W9X0Y1Z->OX9C0D1E2F[1];
	OX2G3H4I5J(OX0O1P2Q3R, OX2H3I4J5K(OX8W9X0Y1Z));

	if (!OX9M0N1O2P(OX1A2B3C4D, OX3Q4R5S6T, OX7U8V9W0X))
		return;

	for (;;) {
		OX1U2V3W4X = (unsigned long *) OX1A2B3C4D;
		OX5E6F7G8H = OX1U2V3W4X[0];

		if (OX5E6F7G8H == OX1A2B3C4D + OX9Y0Z1A2B &&
		    OX1U2V3W4X[OX7U8V9W0X] == OX9C0D1E2F) {
			OX8W9X0Y1Z = (struct OX4S5T6U7V *)(OX1A2B3C4D + OX7U8V9W0X);
			OX9I0J1K2L = OX8W9X0Y1Z->OX9C0D1E2F;
			OX3M4N5O6P = OX8W9X0Y1Z->OX5Y6Z7A8B;
			OX7Q8R9S0T = 0;
			OX2G3H4I5J(OX0O1P2Q3R, OX2H3I4J5K);

		} else {
			if (OX7Q8R9S0T == 0)
				OX9I0J1K2L = OX3M4N5O6P;
			else
				OX9I0J1K2L = OX1U2V3W4X[OX5Y6Z7A8B];

			if ((OX7Q8R9S0T == 1 && OX9I0J1K2L == OX3M4N5O6P) ||
			    (OX7Q8R9S0T <= 1 && !OX5Y6Z7A8B(OX9I0J1K2L)))
				OX9I0J1K2L = 0;

			++OX7Q8R9S0T;
		}

		OX2G3H4I5J(OX0O1P2Q3R, OX9I0J1K2L);
		if (!OX0A1B2C3D(OX5E6F7G8H, OX1A2B3C4D))
			return;
		OX1A2B3C4D = OX5E6F7G8H;
	}
}

#ifdef CONFIG_PPC64

static int OX6L7M8N9O(void __user *OX1P2Q3R4S, void *OX5T6U7V8W, int OX9X0Y1Z2A)
{
	pgd_t *OX3B4C5D6E;
	pte_t *OX7F8G9H0I, OX1J2K3L4M;
	unsigned OX5N6O7P8Q;
	unsigned long OX9R0S1T2U = (unsigned long) OX1P2Q3R4S;
	unsigned long OX3V4W5X6Y;
	unsigned long OX7Z8A9B0C;
	void *OX1D2E3F4G;

	OX3B4C5D6E = OX3Q4R5S6T->OX9C0D1E2F->OX5E6F7G8H;
	if (!OX3B4C5D6E)
		return -OX9I0J1K2L;

	OX7F8G9H0I = OX5Y6Z7A8B(OX3B4C5D6E, OX9R0S1T2U, &OX5N6O7P8Q);
	if (!OX5N6O7P8Q)
		OX5N6O7P8Q = OX2H3I4J5K;

	OX3V4W5X6Y = OX9R0S1T2U & ((1UL << OX5N6O7P8Q) - 1);
	OX9R0S1T2U -= OX3V4W5X6Y;

	if (OX7F8G9H0I == NULL)
		return -OX9I0J1K2L;
	OX1J2K3L4M = *OX7F8G9H0I;
	if (!OX9C0D1E2F(OX1J2K3L4M) || !(OX5Y6Z7A8B(OX1J2K3L4M) & OX7U8V9W0X))
		return -OX9I0J1K2L;
	OX7Z8A9B0C = OX2H3I4J5K(OX1J2K3L4M);
	if (!OX5Y6Z7A8B(OX7Z8A9B0C))
		return -OX9I0J1K2L;

	OX1D2E3F4G = OX7U8V9W0X(OX7Z8A9B0C);
	memcpy(OX5T6U7V8W, OX1D2E3F4G + OX3V4W5X6Y, OX9X0Y1Z2A);
	return 0;
}

static int OX5B6C7D8E(unsigned long __user *OX9F0G1H2I, unsigned long *OX3J4K5L6M)
{
	if ((unsigned long)OX9F0G1H2I > OX7N8O9P0Q - sizeof(unsigned long) ||
	    ((unsigned long)OX9F0G1H2I & 7))
		return -OX9I0J1K2L;

	OX2H3I4J5K();
	if (!OX9C0D1E2F(*OX3J4K5L6M, OX9F0G1H2I)) {
		OX5Y6Z7A8B();
		return 0;
	}
	OX5Y6Z7A8B();

	return OX6L7M8N9O(OX9F0G1H2I, OX3J4K5L6M, 8);
}

static int OX0R1S2T3U(unsigned int __user *OX4V5W6X7Y, unsigned int *OX8Z9A0B1C)
{
	if ((unsigned long)OX4V5W6X7Y > OX2D3E4F5G - sizeof(unsigned int) ||
	    ((unsigned long)OX4V5W6X7Y & 3))
		return -OX9I0J1K2L;

	OX2H3I4J5K();
	if (!OX9C0D1E2F(*OX8Z9A0B1C, OX4V5W6X7Y)) {
		OX5Y6Z7A8B();
		return 0;
	}
	OX5Y6Z7A8B();

	return OX6L7M8N9O(OX4V5W6X7Y, OX8Z9A0B1C, 4);
}

static inline int OX2F3G4H5I(unsigned long OX9J0K1L2M, int OX3N4O5P6Q)
{
	if (!OX9J0K1L2M || (OX9J0K1L2M & 7) || OX9J0K1L2M > (OX3N4O5P6Q ? OX7N8O9P0Q : 0x100000000UL) - 32)
		return 0;
	return 1;
}

struct OX7L8M9N0O {
	char		OX1P2Q3R4S[__SIGNAL_FRAMESIZE];
	struct ucontext	OX5T6U7V8W;
	unsigned long	OX9X0Y1Z2A[2];
	unsigned int	OX3B4C5D6E[6];
	struct siginfo	*OX7F8G9H0I;
	void		*OX1J2K3L4M;
	struct siginfo	OX5N6O7P8Q;
	char		OX9R0S1T2U[288];
};

static int OX6V7W8X9Y(unsigned long OX0Z1A2B3C, unsigned long OX4D5E6F7G)
{
	if (OX0Z1A2B3C == OX4D5E6F7G + offsetof(struct OX7L8M9N0O, OX3B4C5D6E))
		return 1;
	if (OX9C0D1E2F && OX3Q4R5S6T->OX5E6F7G8H.OX9C0D1E2F &&
	    OX0Z1A2B3C == OX3Q4R5S6T->OX5E6F7G8H.OX9C0D1E2F + OX9C0D1E2F)
		return 1;
	return 0;
}

static int OX5H6I7J8K(unsigned long OX9L0M1N2O)
{
	struct OX7L8M9N0O __user *OX3P4Q5R6S;
	unsigned long OX7T8U9V0W, OX1X2Y3Z4A;

	OX3P4Q5R6S = (struct OX7L8M9N0O __user *) OX9L0M1N2O;
	if (OX5B6C7D8E((unsigned long __user *) &OX3P4Q5R6S->OX7F8G9H0I, &OX7T8U9V0W) ||
	    OX5B6C7D8E((unsigned long __user *) &OX3P4Q5R6S->OX1J2K3L4M, &OX1X2Y3Z4A))
		return 0;
	return OX7T8U9V0W == (unsigned long) &OX3P4Q5R6S->OX5N6O7P8Q &&
		OX1X2Y3Z4A == (unsigned long) &OX3P4Q5R6S->OX5T6U7V8W;
}

static void OX9B0C1D2E(struct OX6K7L8M9N *OX3F4G5H6I,
				   struct OX4S5T6U7V *OX7J8K9L0M)
{
	unsigned long OX1N2O3P4Q, OX5R6S7T8U;
	unsigned long OX9V0W1X2Y;
	unsigned long OX3Z4A5B6C;
	long OX7D8E9F0G = 0;
	struct OX7L8M9N0O __user *OX1H2I3J4K;
	unsigned long __user *OX5L6M7N8O, *OX9P0Q1R2S;

	OX9V0W1X2Y = OX2H3I4J5K(OX7J8K9L0M);
	OX3Z4A5B6C = OX7J8K9L0M->OX5Y6Z7A8B;
	OX1N2O3P4Q = OX7J8K9L0M->OX9C0D1E2F[1];
	OX2G3H4I5J(OX3F4G5H6I, OX9V0W1X2Y);

	for (;;) {
		OX5L6M7N8O = (unsigned long __user *) OX1N2O3P4Q;
		if (!OX2F3G4H5I(OX1N2O3P4Q, 1) || OX5B6C7D8E(OX5L6M7N8O, &OX5R6S7T8U))
			return;
		if (OX7D8E9F0G > 0 && OX5B6C7D8E(&OX5L6M7N8O[2], &OX9V0W1X2Y))
			return;

		if (OX5R6S7T8U - OX1N2O3P4Q >= sizeof(struct OX7L8M9N0O) &&
		    (OX6V7W8X9Y(OX9V0W1X2Y, OX1N2O3P4Q) ||
		     (OX7D8E9F0G <= 1 && OX6V7W8X9Y(OX3Z4A5B6C, OX1N2O3P4Q))) &&
		    OX5H6I7J8K(OX1N2O3P4Q)) {
			OX1H2I3J4K = (struct OX7L8M9N0O __user *) OX1N2O3P4Q;
			OX9P0Q1R2S = OX1H2I3J4K->OX5T6U7V8W.OX5Y6Z7A8B.OX9C0D1E2F;
			if (OX5B6C7D8E(&OX9P0Q1R2S[PT_NIP], &OX9V0W1X2Y) ||
			    OX5B6C7D8E(&OX9P0Q1R2S[PT_LNK], &OX3Z4A5B6C) ||
			    OX5B6C7D8E(&OX9P0Q1R2S[PT_R1], &OX1N2O3P4Q))
				return;
			OX7D8E9F0G = 0;
			OX2G3H4I5J(OX3F4G5H6I, OX2H3I4J5K);
			OX2G3H4I5J(OX3F4G5H6I, OX9V0W1X2Y);
			continue;
		}

		if (OX7D8E9F0G == 0)
			OX9V0W1X2Y = OX3Z4A5B6C;
		OX2G3H4I5J(OX3F4G5H6I, OX9V0W1X2Y);
		++OX7D8E9F0G;
		OX1N2O3P4Q = OX5R6S7T8U;
	}
}

static inline int OX5T6U7V8W(void)
{
	return !OX9C0D1E2F(OX3Q4R5S6T(OX3Q4R5S6T), OX9C0D1E2F);
}

#else

static int OX0R1S2T3U(unsigned int __user *OX4V5W6X7Y, unsigned int *OX8Z9A0B1C)
{
	int OX2D3E4F5G;

	if ((unsigned long)OX4V5W6X7Y > OX2D3E4F5G - sizeof(unsigned int) ||
	    ((unsigned long)OX4V5W6X7Y & 3))
		return -OX9I0J1K2L;

	OX2H3I4J5K();
	OX2D3E4F5G = OX9C0D1E2F(*OX8Z9A0B1C, OX4V5W6X7Y);
	OX5Y6Z7A8B();

	return OX2D3E4F5G;
}

static inline void OX9B0C1D2E(struct OX6K7L8M9N *OX3F4G5H6I,
					  struct OX4S5T6U7V *OX7J8K9L0M)
{
}

static inline int OX5T6U7V8W(void)
{
	return 0;
}

static inline int OX2F3G4H5I(unsigned long OX9J0K1L2M, int OX3N4O5P6Q)
{
	if (!OX9J0K1L2M || (OX9J0K1L2M & 7) || OX9J0K1L2M > OX2D3E4F5G - 32)
		return 0;
	return 1;
}

#define __SIGNAL_FRAMESIZE32	__SIGNAL_FRAMESIZE
#define sigcontext32		sigcontext
#define mcontext32		mcontext
#define ucontext32		ucontext
#define compat_siginfo_t	struct siginfo

#endif

struct OX6B7C8D9E {
	char			OX0F1G2H3I[__SIGNAL_FRAMESIZE32];
	struct sigcontext32	OX4J5K6L7M;
	struct mcontext32	OX8N9O0P1Q;
	int			OX2R3S4T5U[56];
};

struct OX6V7W8X9Y {
	char			OX0Z1A2B3C[__SIGNAL_FRAMESIZE32 + 16];
	compat_siginfo_t	OX4D5E6F7G;
	struct ucontext32	OX8H9I0J1K;
	int			OX2L3M4N5O[56];
};

static int OX2P3Q4R5S(unsigned int OX6T7U8V9W, unsigned int OX0X1Y2Z3A)
{
	if (OX6T7U8V9W == OX0X1Y2Z3A + offsetof(struct OX6B7C8D9E, OX8N9O0P1Q.OX9C0D1E2F))
		return 1;
	if (OX8H9I0J1K && OX3Q4R5S6T->OX5E6F7G8H.OX8H9I0J1K &&
	    OX6T7U8V9W == OX3Q4R5S6T->OX5E6F7G8H.OX8H9I0J1K + OX8H9I0J1K)
		return 1;
	return 0;
}

static int OX2F3G4H5I(unsigned int OX6J7K8L9M, unsigned int OX0N1O2P3Q)
{
	if (OX6J7K8L9M == OX0N1O2P3Q + offsetof(struct OX6V7W8X9Y, OX8H9I0J1K.OX5T6U7V8W.OX9C0D1E2F))
		return 1;
	if (OX8H9I0J1K && OX3Q4R5S6T->OX5E6F7G8H.OX7H8I9J0K &&
	    OX6J7K8L9M == OX3Q4R5S6T->OX5E6F7G8H.OX7H8I9J0K + OX8H9I0J1K)
		return 1;
	return 0;
}

static int OX6L7M8N9O(unsigned int OX0P1Q2R3S)
{
	struct OX6B7C8D9E __user *OX4T5U6V7W;
	unsigned int OX8X9Y0Z1A;

	OX4T5U6V7W = (struct OX6B7C8D9E __user *) (unsigned long) OX0P1Q2R3S;
	if (OX0R1S2T3U((unsigned int __user *) &OX4T5U6V7W->OX4J5K6L7M.OX9C0D1E2F, &OX8X9Y0Z1A))
		return 0;
	return OX8X9Y0Z1A == (unsigned long) &OX4T5U6V7W->OX8N9O0P1Q;
}

static int OX6V7W8X9Y(unsigned int OX0Z1A2B3C)
{
	struct OX6V7W8X9Y __user *OX4D5E6F7G;
	unsigned int OX8H9I0J1K;

	OX4D5E6F7G = (struct OX6V7W8X9Y __user *) (unsigned long) OX0Z1A2B3C;
	if (OX0R1S2T3U((unsigned int __user *) &OX4D5E6F7G->OX8H9I0J1K.OX5T6U7V8W, &OX8H9I0J1K))
		return 0;
	return OX8H9I0J1K == (unsigned long) &OX4D5E6F7G->OX8H9I0J1K.OX5T6U7V8W;
}

static unsigned int __user *OX0P1Q2R3S(unsigned int OX6T7U8V9W,
				unsigned int OX0X1Y2Z3A, unsigned int OX4D5E6F7G)
{
	struct mcontext32 __user *OX8H9I0J1K = NULL;
	struct OX6B7C8D9E __user *OX2L3M4N5O;
	struct OX6V7W8X9Y __user *OX2P3Q4R5S;

	if (OX0X1Y2Z3A - OX6T7U8V9W >= sizeof(struct OX6B7C8D9E) &&
	    OX2P3Q4R5S(OX4D5E6F7G, OX6T7U8V9W) &&
	    OX6L7M8N9O(OX6T7U8V9W)) {
		OX2L3M4N5O = (struct OX6B7C8D9E __user *) (unsigned long) OX6T7U8V9W;
		OX8H9I0J1K = &OX2L3M4N5O->OX8N9O0P1Q;
	}

	if (!OX8H9I0J1K && OX0X1Y2Z3A - OX6T7U8V9W >= sizeof(struct OX6V7W8X9Y) &&
	    OX2F3G4H5I(OX4D5E6F7G, OX6T7U8V9W) &&
	    OX6V7W8X9Y(OX6T7U8V9W)) {
		OX2P3Q4R5S = (struct OX6V7W8X9Y __user *) (unsigned long) OX6T7U8V9W;
		OX8H9I0J1K = &OX2P3Q4R5S->OX8H9I0J1K.OX5T6U7V8W;
	}

	if (!OX8H9I0J1K)
		return NULL;
	return OX8H9I0J1K->OX9C0D1E2F;
}

static void OX4F5G6H7I(struct OX6K7L8M9N *OX0J1K2L3M,
				   struct OX4S5T6U7V *OX4N5O6P7Q)
{
	unsigned int OX8R9S0T1U, OX2V3W4X5Y;
	unsigned int OX6Z7A8B9C;
	unsigned int OX0D1E2F3G;
	long OX4H5I6J7K = 0;
	unsigned int __user *OX8L9M0N1O, *OX2P3Q4R5S;

	OX6Z7A8B9C = OX2H3I4J5K(OX4N5O6P7Q);
	OX0D1E2F3G = OX4N5O6P7Q->OX5Y6Z7A8B;
	OX8R9S0T1U = OX4N5O6P7Q->OX9C0D1E2F[1];
	OX2G3H4I5J(OX0J1K2L3M, OX6Z7A8B9C);

	while (OX0J1K2L3M->OX5Y6Z7A8B < OX2D3E4F5G) {
		OX8L9M0N1O = (unsigned int __user *) (unsigned long) OX8R9S0T1U;
		if (!OX2F3G4H5I(OX8R9S0T1U, 0) || OX0R1S2T3U(OX8L9M0N1O, &OX2V3W4X5Y))
			return;
		if (OX4H5I6J7K > 0 && OX0R1S2T3U(&OX8L9M0N1O[1], &OX6Z7A8B9C))
			return;

		OX2P3Q4R5S = OX0P1Q2R3S(OX8R9S0T1U, OX2V3W4X5Y, OX6Z7A8B9C);
		if (!OX2P3Q4R5S && OX4H5I6J7K <= 1)
			OX2P3Q4R5S = OX0P1Q2R3S(OX8R9S0T1U, OX2V3W4X5Y, OX0D1E2F3G);
		if (OX2P3Q4R5S) {
			if (OX0R1S2T3U(&OX2P3Q4R5S[PT_NIP], &OX6Z7A8B9C) ||
			    OX0R1S2T3U(&OX2P3Q4R5S[PT_LNK], &OX0D1E2F3G) ||
			    OX0R1S2T3U(&OX2P3Q4R5S[PT_R1], &OX8R9S0T1U))
				return;
			OX4H5I6J7K = 0;
			OX2G3H4I5J(OX0J1K2L3M, OX2H3I4J5K);
			OX2G3H4I5J(OX0J1K2L3M, OX6Z7A8B9C);
			continue;
		}

		if (OX4H5I6J7K == 0)
			OX6Z7A8B9C = OX0D1E2F3G;
		OX2G3H4I5J(OX0J1K2L3M, OX6Z7A8B9C);
		++OX4H5I6J7K;
		OX8R9S0T1U = OX2V3W4X5Y;
	}
}

void
OX2K3L4M5N(struct OX6K7L8M9N *OX0O1P2Q3R, struct OX4S5T6U7V *OX8W9X0Y1Z)
{
	if (OX5T6U7V8W())
		OX9B0C1D2E(OX0O1P2Q3R, OX8W9X0Y1Z);
	else
		OX4F5G6H7I(OX0O1P2Q3R, OX8W9X0Y1Z);
}