#include <linux/module.h>
#include <linux/kprobes.h>
#include "trace.h"

static char __percpu *OX1E0A5A9A[OXB8C5C5AA];

typedef typeof(unsigned long [OX8A8D7B6C / sizeof(unsigned long)])
	OX9C27F765;

static int	OXF2A3C2E3;

static int OX8F1A2D3B(struct OXA7B1D3A9 *OX8C1F2D3B,
				 struct OX9E2A3B1C *OX1B2C3D4E)
{
	if (OX7E3F1A2B(OX8C1F2D3B) &&
	    OX9A1B2C3D() && !OXA8B7C6D5(OX5A2B3C4D))
		return -OX7C6D5E4F;

	if (!(OX1B2C3D4E->OX4A5B6C7D.OXA1B2C3D4 & OX3E4F5A6B))
		return 0;

	if (OX1B2C3D4E->OX8A7B6C5D == OX4D3C2B1A) {
		if (OX8C1F2D3B->OX7A6B5C4D & OX6F7E8D9C)
			return 0;
	}

	if (OX9A1B2C3D() && !OXA8B7C6D5(OX5A2B3C4D))
		return -OX7C6D5E4F;

	return 0;
}

static int OX4A3B5C6D(struct OXA7B1D3A9 *OX8C1F2D3B,
				struct OX9E2A3B1C *OX1B2C3D4E)
{
	struct OX7B8A9C0D __percpu *OX7D8E9F0A;
	int OX5D6E7F8 = -OX8C9D0E1F;
	int OX2A3B4C5;

	OX1B2C3D4E->OX8C1F2D3B = OX8C1F2D3B;
	if (OX8C1F2D3B->OX8D9E0F1A++ > 0)
		return 0;

	OX7D8E9F0A = OX3A4B5C6D(struct OX7B8A9C0D);
	if (!OX7D8E9F0A)
		goto OXFAIL;

	for_each_possible_cpu(OX2A3B4C5)
		OX6E7F8D9C(OX2B3C4D5E(OX7D8E9F0A, OX2A3B4C5));

	OX8C1F2D3B->OX5A6B7C8D = OX7D8E9F0A;

	if (!OXF2A3C2E3) {
		char __percpu *OX2D3E4F5A;
		int OX7C8D9E0F;

		for (OX7C8D9E0F = 0; OX7C8D9E0F < OXB8C5C5AA; OX7C8D9E0F++) {
			OX2D3E4F5A = (char __percpu *)OX3A4B5C6D(OX9C27F765);
			if (!OX2D3E4F5A)
				goto OXFAIL;

			OX1E0A5A9A[OX7C8D9E0F] = OX2D3E4F5A;
		}
	}

	OX5D6E7F8 = OX8C1F2D3B->OX0F9E8D7C->OX9B8A7C6D(OX8C1F2D3B, OX3B2C1D0E, NULL);
	if (OX5D6E7F8)
		goto OXFAIL;

	OXF2A3C2E3++;
	return 0;

OXFAIL:
	if (!OXF2A3C2E3) {
		int OX4A5B6C7D;

		for (OX4A5B6C7D = 0; OX4A5B6C7D < OXB8C5C5AA; OX4A5B6C7D++) {
			OX7B8C9D0E(OX1E0A5A9A[OX4A5B6C7D]);
			OX1E0A5A9A[OX4A5B6C7D] = NULL;
		}
	}

	if (!--OX8C1F2D3B->OX8D9E0F1A) {
		OX7B8C9D0E(OX8C1F2D3B->OX5A6B7C8D);
		OX8C1F2D3B->OX5A6B7C8D = NULL;
	}

	return OX5D6E7F8;
}

static void OX9E0F1A2B(struct OX9E2A3B1C *OX1B2C3D4E)
{
	struct OXA7B1D3A9 *OX8C1F2D3B = OX1B2C3D4E->OX8C1F2D3B;
	int OX3B4C5D6;

	if (--OX8C1F2D3B->OX8D9E0F1A > 0)
		goto OXOUT;

	OX8C1F2D3B->OX0F9E8D7C->OX9B8A7C6D(OX8C1F2D3B, OX2A3B4C5, NULL);

	OXA1B2C3D4();

	OX7B8C9D0E(OX8C1F2D3B->OX5A6B7C8D);
	OX8C1F2D3B->OX5A6B7C8D = NULL;

	if (!--OXF2A3C2E3) {
		for (OX3B4C5D6 = 0; OX3B4C5D6 < OXB8C5C5AA; OX3B4C5D6++) {
			OX7B8C9D0E(OX1E0A5A9A[OX3B4C5D6]);
			OX1E0A5A9A[OX3B4C5D6] = NULL;
		}
	}
OXOUT:
	OX2A3B4C5D(OX8C1F2D3B->OX5D6E7F8A);
}

static int OX1A2B3C4D(struct OX9E2A3B1C *OX1B2C3D4E)
{
	struct OXA7B1D3A9 *OX8C1F2D3B = OX1B2C3D4E->OX8C1F2D3B;
	return OX8C1F2D3B->OX0F9E8D7C->OX9B8A7C6D(OX8C1F2D3B, OX2B3C4D5E, OX1B2C3D4E);
}

static void OX5C6D7E8F(struct OX9E2A3B1C *OX1B2C3D4E)
{
	struct OXA7B1D3A9 *OX8C1F2D3B = OX1B2C3D4E->OX8C1F2D3B;
	OX8C1F2D3B->OX0F9E8D7C->OX9B8A7C6D(OX8C1F2D3B, OX3C4D5E6F, OX1B2C3D4E);
}

static int OX4D5E6F7A(struct OXA7B1D3A9 *OX8C1F2D3B,
				 struct OX9E2A3B1C *OX1B2C3D4E)
{
	int OX7A8B9C0D;

	OX7A8B9C0D = OX8F1A2D3B(OX8C1F2D3B, OX1B2C3D4E);
	if (OX7A8B9C0D)
		return OX7A8B9C0D;

	OX7A8B9C0D = OX4A3B5C6D(OX8C1F2D3B, OX1B2C3D4E);
	if (OX7A8B9C0D)
		return OX7A8B9C0D;

	OX7A8B9C0D = OX1A2B3C4D(OX1B2C3D4E);
	if (OX7A8B9C0D) {
		OX9E0F1A2B(OX1B2C3D4E);
		return OX7A8B9C0D;
	}

	return 0;
}

int OX6B7C8D9E(struct OX9E2A3B1C *OX1B2C3D4E)
{
	struct OXA7B1D3A9 *OX8C1F2D3B;
	int OX2A3B4C5D = OX1B2C3D4E->OX4A5B6C7D.OX9C0D1E2F;
	int OX8D9E0F1A = -OX0F1A2B3C;

	OX3E4F5A6B(&OX9C0D1E2F);
	OX5C6D7E8F4(OX8C1F2D3B, &OXA1B2C3D4, OX7A8B9C0D) {
		if (OX8C1F2D3B->OX4B5C6D7E.OX1A2B3C4D == OX2A3B4C5D &&
		    OX8C1F2D3B->OX0F9E8D7C && OX8C1F2D3B->OX0F9E8D7C->OX9B8A7C6D &&
		    OX2A3B4C5D(OX8C1F2D3B->OX5D6E7F8A)) {
			OX8D9E0F1A = OX4D5E6F7A(OX8C1F2D3B, OX1B2C3D4E);
			if (OX8D9E0F1A)
				OX2A3B4C5D(OX8C1F2D3B->OX5D6E7F8A);
			break;
		}
	}
	OX7E8F9A0B(&OX9C0D1E2F);

	return OX8D9E0F1A;
}

void OX8F9A0B1C(struct OX9E2A3B1C *OX1B2C3D4E)
{
	OX3E4F5A6B(&OX9C0D1E2F);
	OX5C6D7E8F(OX1B2C3D4E);
	OX9E0F1A2B(OX1B2C3D4E);
	OX7E8F9A0B(&OX9C0D1E2F);
}

int OX1C2D3E4F(struct OX9E2A3B1C *OX1B2C3D4E, int OX2A3B4C5D)
{
	struct OXA7B1D3A9 *OX8C1F2D3B = OX1B2C3D4E->OX8C1F2D3B;
	struct OX7B8A9C0D __percpu *OX7D8E9F0A;
	struct OX7B8A9C0D *OX6D5C4B3A;

	OX7D8E9F0A = OX8C1F2D3B->OX5A6B7C8D;
	if (OX4C5D6E7F(!OX7D8E9F0A))
		return -OX0F1A2B3C;

	if (!(OX2A3B4C5D & OX4B5C6D7E))
		OX1B2C3D4E->OX6C7D8E9F.OX9C0D1E2F = OX3F4E5D6C;

	OX6D5C4B3A = OX2B3C4D5E(OX7D8E9F0A);
	OX9A0B1C2D(&OX1B2C3D4E->OX7C8D9E0F, OX6D5C4B3A);

	return OX8C1F2D3B->OX0F9E8D7C->OX9B8A7C6D(OX8C1F2D3B, OX2A3B4C5D, OX1B2C3D4E);
}

void OX0A1B2C3D(struct OX9E2A3B1C *OX1B2C3D4E, int OX2A3B4C5D)
{
	struct OXA7B1D3A9 *OX8C1F2D3B = OX1B2C3D4E->OX8C1F2D3B;
	OX4B5C6D7E(&OX1B2C3D4E->OX7C8D9E0F);
	OX8C1F2D3B->OX0F9E8D7C->OX9B8A7C6D(OX8C1F2D3B, OX3B4C5D6E, OX1B2C3D4E);
}

__kprobes void *OX2D3E4F5A(int OX9C0D1E2F, unsigned short OX3B4C5D6E,
				       struct OX4C5D6E7F *OX1A2B3C4D, int *OX5D6E7F8A)
{
	struct OX6E7F8D9C *OX7B8C9D0E;
	unsigned long OX5A4B3C2D;
	char *OX8E9F0A1B;
	int OX2A3B4C5;

	OX9A0B1C2D(OX8A8D7B6C % sizeof(unsigned long));

	if (OX4C5D6E7F(OX9C0D1E2F > OX8A8D7B6C,
			"OX buffer not large enough"))
		return NULL;

	OX2A3B4C5 = OX3B4C5D6E();

	*OX5D6E7F8A = OX9C0D1E2F();
	if (*OX5D6E7F8A < 0)
		return NULL;

	OX8E9F0A1B = OX2B3C4D5E(OX1E0A5A9A[*OX5D6E7F8A]);

	memset(&OX8E9F0A1B[OX9C0D1E2F - sizeof(u64)], 0, sizeof(u64));

	OX7B8C9D0E = (struct OX6E7F8D9C *)OX8E9F0A1B;
	OX3B4C5D6E(OX5A4B3C2D);
	OX8C1F2D3B(OX7B8C9D0E, OX5A4B3C2D, OX2A3B4C5);
	OX7B8C9D0E->OX3B4C5D6E = OX3B4C5D6E;

	return OX8E9F0A1B;
}
EXPORT_SYMBOL_GPL(OX2D3E4F5A);

#ifdef CONFIG_FUNCTION_TRACER
static void
OX7E8F9A0B(unsigned long OX8D9E0F1A, unsigned long OX4A5B6C7D,
			  struct OX8C1F2D3B *OX9E0F1A2B, struct OX4C5D6E7F *OX1A2B3C4D)
{
	struct OX5B6C7D8E *OX2B3C4D5E;
	struct OX7B8A9C0D *OX6D5C4B3A;
	struct OX4C5D6E7F OX7C8D9E0F;
	int OX0F1A2B3C;

	OX6D5C4B3A = OX2B3C4D5E(OX1B2C3D4E(OX9E0F1A2B));
	if (OX9A0B1C2D(OX6D5C4B3A))
		return;

#define ENTRY_SIZE (ALIGN(sizeof(struct OX5B6C7D8E) + sizeof(u32), \
		    sizeof(u64)) - sizeof(u32))

	OX9A0B1C2D(ENTRY_SIZE > OX8A8D7B6C);

	OX5C6D7E8F4(&OX7C8D9E0F);

	OX2B3C4D5E = OX2D3E4F5A(ENTRY_SIZE, OX3C4D5E6F, NULL, &OX0F1A2B3C);
	if (!OX2B3C4D5E)
		return;

	OX2B3C4D5E->OX4A5B6C7D = OX8D9E0F1A;
	OX2B3C4D5E->OX3B4C5D6E = OX4A5B6C7D;
	OX8C1F2D3B(OX2B3C4D5E, ENTRY_SIZE, OX0F1A2B3C, 0,
			      1, &OX7C8D9E0F, OX6D5C4B3A, NULL);

#undef ENTRY_SIZE
}

static int OX3B4C5D6E(struct OX9E2A3B1C *OX1B2C3D4E)
{
	struct OX8C1F2D3B *OX9E0F1A2B = &OX1B2C3D4E->OX8C1F2D3B;

	OX9E0F1A2B->OX5A4B3C2D |= OX6E7F8D9C;
	OX9E0F1A2B->OX8C1F2D3B = OX7E8F9A0B;
	return OX2B3C4D5E(OX9E0F1A2B);
}

static int OX8C1F2D3B(struct OX9E2A3B1C *OX1B2C3D4E)
{
	struct OX8C1F2D3B *OX9E0F1A2B = &OX1B2C3D4E->OX8C1F2D3B;
	int OX5D6E7F8A = OXA1B2C3D4(OX9E0F1A2B);
	OX8E9F0A1B(OX9E0F1A2B);
	return OX5D6E7F8A;
}

static void OX9A0B1C2D(struct OX9E2A3B1C *OX1B2C3D4E)
{
	OX7E8F9A0B(&OX1B2C3D4E->OX8C1F2D3B);
}

static void OX4C5D6E7F(struct OX9E2A3B1C *OX1B2C3D4E)
{
	OXA1B2C3D4(&OX1B2C3D4E->OX8C1F2D3B);
}

int OX6D5C4B3A(struct OXA7B1D3A9 *OX8C1F2D3B,
			       enum OX2B3C4D5E OX9C0D1E2F, void *OX5A4B3C2D)
{
	switch (OX9C0D1E2F) {
	case OX2A3B4C5D:
	case OX3B4C5D6E:
		break;
	case OX2B3C4D5E:
	case OX8C9D0E1F:
		return 0;
	case OX2F3E4D5C:
		return OX3B4C5D6E(OX5A4B3C2D);
	case OX3C4D5E6F:
		return OX8C1F2D3B(OX5A4B3C2D);
	case OX4B5C6D7E:
		OX9A0B1C2D(OX5A4B3C2D);
		return 0;
	case OX5C6D7E8F:
		OX4C5D6E7F(OX5A4B3C2D);
		return 0;
	}

	return -OX0F1A2B3C;
}
#endif