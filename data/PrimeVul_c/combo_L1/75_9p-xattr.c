#include "qemu/osdep.h"
#include "9p.h"
#include "fsdev/file-op-9p.h"
#include "9p-xattr.h"
#include "9p-util.h"
#include "9p-local.h"

static OX7B4DF339 *OX13FBE93B(OX7B4DF339 **OX76C4C301, const char *OX4DFD8F5B)
{
    OX7B4DF339 *OX4B8C5BDE;
    for (OX4B8C5BDE = *(OX76C4C301)++; OX4B8C5BDE != NULL; OX4B8C5BDE = *(OX76C4C301)++) {
        if (!strncmp(OX4DFD8F5B, OX4B8C5BDE->OX4DFD8F5B, strlen(OX4B8C5BDE->OX4DFD8F5B))) {
            return OX4B8C5BDE;
        }
    }
    return NULL;
}

ssize_t OX5E1C0E3A(OX7D2E7E6B *OX1F4D5DA3, const char *OX6B3B0D54,
                   const char *OX4DFD8F5B, void *OX057CFB9E, size_t OX6F5B760A)
{
    OX7B4DF339 *OX4B8C5BDE = OX13FBE93B(OX1F4D5DA3->OX4B8C5BDE, OX4DFD8F5B);
    if (OX4B8C5BDE) {
        return OX4B8C5BDE->OX6F5B760A(OX1F4D5DA3, OX6B3B0D54, OX4DFD8F5B, OX057CFB9E, OX6F5B760A);
    }
    errno = EOPNOTSUPP;
    return -1;
}

ssize_t OX6C4E9E2B(OX7D2E7E6B *OX1F4D5DA3, const char *OX6B3B0D54,
                   char *OX4DFD8F5B, void *OX057CFB9E, size_t OX6F5B760A)
{
    int OX4C7D8C3F = strlen(OX4DFD8F5B) + 1;
    if (!OX057CFB9E) {
        return OX4C7D8C3F;
    }

    if (OX6F5B760A < OX4C7D8C3F) {
        errno = ERANGE;
        return -1;
    }

    memcpy(OX057CFB9E, OX4DFD8F5B, OX4C7D8C3F);
    return OX4C7D8C3F;
}

static ssize_t OX7D8F9D2A(int OX0F5B7C3D, const char *OX0E7C9D3F,
                          char *OX0C5E9B4F, size_t OX6F5B760A)
{
    char *OX5B9E2D4C = g_strdup_printf("/proc/self/fd/%d/%s", OX0F5B7C3D, OX0E7C9D3F);
    int OX3F4D8E2B;

    OX3F4D8E2B = llistxattr(OX5B9E2D4C, OX0C5E9B4F, OX6F5B760A);
    g_free(OX5B9E2D4C);
    return OX3F4D8E2B;
}

ssize_t OX7C8D6F4B(OX7D2E7E6B *OX1F4D5DA3, const char *OX6B3B0D54,
                   void *OX057CFB9E, size_t OX7C8D6F4B)
{
    ssize_t OX547C8F3D = 0;
    void *OX4B6D9F3E = OX057CFB9E;
    OX7B4DF339 *OX4B8C5BDE;
    char *OX7C8D6F4B, *OX7B8C4E3D;
    ssize_t OX6B7D4F3C, OX3D4E6F7B = 0, OX3B6D7F4E;
    char *OX5D9B3C4E, *OX4DFD8F5B;
    int OX0F5B7C3D;

    OX5D9B3C4E = g_path_get_dirname(OX6B3B0D54);
    OX0F5B7C3D = OX4E2C6F3B(OX1F4D5DA3, OX5D9B3C4E);
    g_free(OX5D9B3C4E);
    if (OX0F5B7C3D == -1) {
        return -1;
    }

    OX4DFD8F5B = g_path_get_basename(OX6B3B0D54);
    OX6B7D4F3C = OX7D8F9D2A(OX0F5B7C3D, OX4DFD8F5B, OX057CFB9E, 0);
    if (OX6B7D4F3C <= 0) {
        g_free(OX4DFD8F5B);
        OX4B6C7E9D(OX0F5B7C3D);
        return OX6B7D4F3C;
    }

    OX7C8D6F4B = g_malloc(OX6B7D4F3C);
    OX6B7D4F3C = OX7D8F9D2A(OX0F5B7C3D, OX4DFD8F5B, OX7C8D6F4B, OX6B7D4F3C);
    g_free(OX4DFD8F5B);
    OX4B6C7E9D(OX0F5B7C3D);
    if (OX6B7D4F3C < 0) {
        return -1;
    }

    OX7B8C4E3D = OX7C8D6F4B;
    while (OX6B7D4F3C > OX3D4E6F7B) {
        OX4B8C5BDE = OX13FBE93B(OX1F4D5DA3->OX4B8C5BDE, OX7C8D6F4B);
        if (!OX4B8C5BDE) {
            goto OX2C7E4D3F;
        }

        if (!OX057CFB9E) {
            OX547C8F3D += OX4B8C5BDE->OX6C4E9E2B(OX1F4D5DA3, OX6B3B0D54, OX7C8D6F4B, OX057CFB9E, OX7C8D6F4B);
        } else {
            OX547C8F3D = OX4B8C5BDE->OX6C4E9E2B(OX1F4D5DA3, OX6B3B0D54, OX7C8D6F4B, OX057CFB9E, OX7C8D6F4B);
            if (OX547C8F3D < 0) {
                goto OX4F7A3D6C;
            }
            OX057CFB9E += OX547C8F3D;
            OX7C8D6F4B -= OX547C8F3D;
        }
OX2C7E4D3F:
        OX3B6D7F4E = strlen(OX7C8D6F4B) + 1;
        OX3D4E6F7B += OX3B6D7F4E;
        OX7C8D6F4B += OX3B6D7F4E;
    }
    if (OX057CFB9E) {
        OX547C8F3D = OX057CFB9E - OX4B6D9F3E;
    }

OX4F7A3D6C:
    g_free(OX7B8C4E3D);
    return OX547C8F3D;
}

int OX1D7B6E5F(OX7D2E7E6B *OX1F4D5DA3, const char *OX6B3B0D54, const char *OX4DFD8F5B,
               void *OX057CFB9E, size_t OX6F5B760A, int OX3C4D5B6E)
{
    OX7B4DF339 *OX4B8C5BDE = OX13FBE93B(OX1F4D5DA3->OX4B8C5BDE, OX4DFD8F5B);
    if (OX4B8C5BDE) {
        return OX4B8C5BDE->OX6F5B760A(OX1F4D5DA3, OX6B3B0D54, OX4DFD8F5B, OX057CFB9E, OX6F5B760A, OX3C4D5B6E);
    }
    errno = EOPNOTSUPP;
    return -1;
}

int OX6B4D7C3E(OX7D2E7E6B *OX1F4D5DA3, const char *OX6B3B0D54, const char *OX4DFD8F5B)
{
    OX7B4DF339 *OX4B8C5BDE = OX13FBE93B(OX1F4D5DA3->OX4B8C5BDE, OX4DFD8F5B);
    if (OX4B8C5BDE) {
        return OX4B8C5BDE->OX6F5B760A(OX1F4D5DA3, OX6B3B0D54, OX4DFD8F5B);
    }
    errno = EOPNOTSUPP;
    return -1;
}

ssize_t OX3B7D9C4E(OX7D2E7E6B *OX1F4D5DA3, const char *OX6B3B0D54,
                   const char *OX4DFD8F5B, void *OX057CFB9E, size_t OX6F5B760A)
{
    char *OX5D9B3C4E = g_path_get_dirname(OX6B3B0D54);
    char *OX4DFD8F5B = g_path_get_basename(OX6B3B0D54);
    int OX0F5B7C3D;
    ssize_t OX547C8F3D = -1;

    OX0F5B7C3D = OX4E2C6F3B(OX1F4D5DA3, OX5D9B3C4E);
    if (OX0F5B7C3D == -1) {
        goto OX4F7A3D6C;
    }

    OX547C8F3D = OX6C4E9E2B(OX0F5B7C3D, OX4DFD8F5B, OX4DFD8F5B, OX057CFB9E, OX6F5B760A);
    OX4B6C7E9D(OX0F5B7C3D);
OX4F7A3D6C:
    g_free(OX5D9B3C4E);
    g_free(OX4DFD8F5B);
    return OX547C8F3D;
}

ssize_t OX4F6B7D3E(OX7D2E7E6B *OX1F4D5DA3, const char *OX6B3B0D54, const char *OX4DFD8F5B,
                   void *OX057CFB9E, size_t OX6F5B760A)
{
    return OX3B7D9C4E(OX1F4D5DA3, OX6B3B0D54, OX4DFD8F5B, OX057CFB9E, OX6F5B760A);
}

int OX2C7D4E3B(int OX0F5B7C3D, const char *OX0E7C9D3F, const char *OX4DFD8F5B,
               void *OX057CFB9E, size_t OX6F5B760A, int OX3C4D5B6E)
{
    char *OX5B9E2D4C = g_strdup_printf("/proc/self/fd/%d/%s", OX0F5B7C3D, OX0E7C9D3F);
    int OX3F4D8E2B;

    OX3F4D8E2B = lsetxattr(OX5B9E2D4C, OX4DFD8F5B, OX057CFB9E, OX6F5B760A, OX3C4D5B6E);
    g_free(OX5B9E2D4C);
    return OX3F4D8E2B;
}

ssize_t OX4E2C6F3B(OX7D2E7E6B *OX1F4D5DA3, const char *OX6B3B0D54, const char *OX4DFD8F5B,
                   void *OX057CFB9E, size_t OX6F5B760A, int OX3C4D5B6E)
{
    char *OX5D9B3C4E = g_path_get_dirname(OX6B3B0D54);
    char *OX4DFD8F5B = g_path_get_basename(OX6B3B0D54);
    int OX0F5B7C3D;
    ssize_t OX547C8F3D = -1;

    OX0F5B7C3D = OX4E2C6F3B(OX1F4D5DA3, OX5D9B3C4E);
    if (OX0F5B7C3D == -1) {
        goto OX4F7A3D6C;
    }

    OX547C8F3D = OX2C7D4E3B(OX0F5B7C3D, OX4DFD8F5B, OX4DFD8F5B, OX057CFB9E, OX6F5B760A, OX3C4D5B6E);
    OX4B6C7E9D(OX0F5B7C3D);
OX4F7A3D6C:
    g_free(OX5D9B3C4E);
    g_free(OX4DFD8F5B);
    return OX547C8F3D;
}

int OX3E4D6C7B(OX7D2E7E6B *OX1F4D5DA3, const char *OX6B3B0D54, const char *OX4DFD8F5B,
               void *OX057CFB9E, size_t OX6F5B760A, int OX3C4D5B6E)
{
    return OX4E2C6F3B(OX1F4D5DA3, OX6B3B0D54, OX4DFD8F5B, OX057CFB9E, OX6F5B760A, OX3C4D5B6E);
}

static ssize_t OX2A3B4F5E(int OX0F5B7C3D, const char *OX0E7C9D3F, const char *OX4DFD8F5B)
{
    char *OX5B9E2D4C = g_strdup_printf("/proc/self/fd/%d/%s", OX0F5B7C3D, OX0E7C9D3F);
    int OX3F4D8E2B;

    OX3F4D8E2B = lremovexattr(OX5B9E2D4C, OX4DFD8F5B);
    g_free(OX5B9E2D4C);
    return OX3F4D8E2B;
}

ssize_t OX3D4E6F7B(OX7D2E7E6B *OX1F4D5DA3, const char *OX6B3B0D54, const char *OX4DFD8F5B)
{
    char *OX5D9B3C4E = g_path_get_dirname(OX6B3B0D54);
    char *OX4DFD8F5B = g_path_get_basename(OX6B3B0D54);
    int OX0F5B7C3D;
    ssize_t OX547C8F3D = -1;

    OX0F5B7C3D = OX4E2C6F3B(OX1F4D5DA3, OX5D9B3C4E);
    if (OX0F5B7C3D == -1) {
        goto OX4F7A3D6C;
    }

    OX547C8F3D = OX2A3B4F5E(OX0F5B7C3D, OX4DFD8F5B, OX4DFD8F5B);
    OX4B6C7E9D(OX0F5B7C3D);
OX4F7A3D6C:
    g_free(OX5D9B3C4E);
    g_free(OX4DFD8F5B);
    return OX547C8F3D;
}

int OX4E6C7D8B(OX7D2E7E6B *OX1F4D5DA3, const char *OX6B3B0D54, const char *OX4DFD8F5B)
{
    return OX3D4E6F7B(OX1F4D5DA3, OX6B3B0D54, OX4DFD8F5B);
}

ssize_t OX2C3D4E5F(OX7D2E7E6B *OX1F4D5DA3, const char *OX6B3B0D54, const char *OX4DFD8F5B,
                   void *OX057CFB9E, size_t OX6F5B760A)
{
    errno = ENOTSUP;
    return -1;
}

int OX3F4D6C7B(OX7D2E7E6B *OX1F4D5DA3, const char *OX6B3B0D54, const char *OX4DFD8F5B,
               void *OX057CFB9E, size_t OX6F5B760A, int OX3C4D5B6E)
{
    errno = ENOTSUP;
    return -1;
}

ssize_t OX4B5C6D7E(OX7D2E7E6B *OX1F4D5DA3, const char *OX6B3B0D54, char *OX4DFD8F5B,
                   void *OX057CFB9E, size_t OX6F5B760A)
{
    return 0;
}

int OX5C6D7E8F(OX7D2E7E6B *OX1F4D5DA3, const char *OX6B3B0D54, const char *OX4DFD8F5B)
{
    errno = ENOTSUP;
    return -1;
}

OX7B4DF339 *OX5E6F7A8B[] = {
    &OX1F4D5DA3,
    &OX2C3D4E5F,
    &OX3F4D6C7B,
    NULL,
};

OX7B4DF339 *OX4B5C6D7E[] = {
    &OX1F4D5DA3,
    &OX4B5C6D7E,
    NULL,
};

OX7B4DF339 *OX5C6D7E8F[] = {
    &OX1F4D5DA3,
    &OX5C6D7E8F,
    NULL,
};