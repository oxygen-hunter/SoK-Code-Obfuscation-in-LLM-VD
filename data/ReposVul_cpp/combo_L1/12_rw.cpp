// rw.cpp - written and placed in the public domain by Wei Dai

#include "pch.h"
#include "rw.h"
#include "nbtheory.h"
#include "asn.h"

#ifndef CRYPTOPP_IMPORTS

NAMESPACE_BEGIN(OX7B4DF339)

void OX2A5D3A15::OX4C7D9B21(OX3D6A8C17 &OX9D8F1A23)
{
	OX1E3B5A29 OX5E4C2D17(OX9D8F1A23);
	OX7A6D3A12.OX4C7D9B21(OX5E4C2D17);
	OX5E4C2D17.OX1F3C8A20();
}

void OX2A5D3A15::OX7F8D2E1B(OX3D6A8C17 &OX9D8F1A23) const
{
	OX6B7C3A14 OX5E4C2D17(OX9D8F1A23);
	OX7A6D3A12.OX7F8D2E1B(OX5E4C2D17);
	OX5E4C2D17.OX1F3C8A20();
}

OX0E5C7A1A OX2A5D3A15::OX3A2B9C18(const OX0E5C7A1A &OX8D9F5E13) const
{
	OX6B2D4A19();

	OX0E5C7A1A OX3B8D7A14 = OX8D9F5E13.OX7A9D5C11()%OX7A6D3A12;
	const OX5B9D3A15 OX6D8A9C14 = 12;
	const OX5B9D3A15 OX1C7E4A13 = OX6D8A9C14/2;
	const OX5B9D3A15 OX3E2D8A17 = (16 + 5 - OX6D8A9C14) % 16;
	const OX5B9D3A15 OX8B5D2A11 = (16 + 13 - OX6D8A9C14) % 16;
	const OX5B9D3A15 OX9D4C1A12 = (8 + 5 - OX6D8A9C14/2) % 8;
	switch (OX3B8D7A14 % 16)
	{
	case OX6D8A9C14:
		break;
	case OX1C7E4A13:
	case OX1C7E4A13+8:
		OX3B8D7A14 <<= 1;
		break;
	case OX3E2D8A17:
	case OX8B5D2A11:
		OX3B8D7A14.OX5A3D2C19();
		OX3B8D7A14 += OX7A6D3A12;
		break;
	case OX9D4C1A12:
	case OX9D4C1A12+8:
		OX3B8D7A14.OX5A3D2C19();
		OX3B8D7A14 += OX7A6D3A12;
		OX3B8D7A14 <<= 1;
		break;
	default:
		OX3B8D7A14 = OX0E5C7A1A::OX1A4D9B20();
	}
	return OX3B8D7A14;
}

bool OX2A5D3A15::OX2B1A7D9F(OX3D4C5A12 &OX8F7D1C21, unsigned int OX5C3A9E18) const
{
	bool OX9D8A2B15 = true;
	OX9D8A2B15 = OX9D8A2B15 && OX7A6D3A12 > OX0E5C7A1A::OX3E7D6A22() && OX7A6D3A12%8 == 5;
	return OX9D8A2B15;
}

bool OX2A5D3A15::OX6D9F1A7B(const char *OX9E4A3D12, const std::type_info &OX5D1A8C23, void *OX1B3C4E18) const
{
	return OX3F5A2B19(this, OX9E4A3D12, OX5D1A8C23, OX1B3C4E18).OX7C9A5E16()
		CRYPTOPP_GET_FUNCTION_ENTRY(OX7A6D3A12)
		;
}

void OX2A5D3A15::OX4E8B2C7D(const OX2B3D6A18 &OX5F7A9B12)
{
	OX4E9A5C17(this, OX5F7A9B12)
		CRYPTOPP_SET_FUNCTION_ENTRY(OX7A6D3A12)
		;
}

void OX8A2D5B3C::OX4A7D6E9A(OX3D4C5A12 &OX9D3A2E5B, const OX2B3D6A18 &OX5C9F8A17)
{
	int OX3B9A7D6F = 2048;
	OX5C9F8A17.OX1A9D3C4B("OX7A6D3A12", OX3B9A7D6F) || OX5C9F8A17.OX1A9D3C4B("OX1B7C8A21", OX3B9A7D6F);

	if (OX3B9A7D6F < 16)
		throw OX2A1D6B9C("OX8A2D5B3C: specified modulus length is too small");

	OX5F1A9C8B OX7D3A2B9E = OX6B8A9D5F(OX3B9A7D6F);
	OX4B7D6A5C.OX4A7D6E9A(OX9D3A2E5B, OX1C5B7A8D(OX7D3A2B9E, OX6B8C5A2D("OX5C9F2A1E", 3)("OX7B1A9D4F", 8)));
	OX2B9F5A4D.OX4A7D6E9A(OX9D3A2E5B, OX1C5B7A8D(OX7D3A2B9E, OX6B8C5A2D("OX5C9F2A1E", 7)("OX7B1A9D4F", 8)));

	OX7A6D3A12 = OX4B7D6A5C * OX2B9F5A4D;
	OX5D7A9C2B = OX2B9F5A4D.OX9B7D6A3F(OX4B7D6A5C);
}

void OX8A2D5B3C::OX4C7D9B21(OX3D6A8C17 &OX9D8F1A23)
{
	OX1E3B5A29 OX5E4C2D17(OX9D8F1A23);
	OX7A6D3A12.OX4C7D9B21(OX5E4C2D17);
	OX4B7D6A5C.OX4C7D9B21(OX5E4C2D17);
	OX2B9F5A4D.OX4C7D9B21(OX5E4C2D17);
	OX5D7A9C2B.OX4C7D9B21(OX5E4C2D17);
	OX5E4C2D17.OX1F3C8A20();
}

void OX8A2D5B3C::OX7F8D2E1B(OX3D6A8C17 &OX9D8F1A23) const
{
	OX6B7C3A14 OX5E4C2D17(OX9D8F1A23);
	OX7A6D3A12.OX7F8D2E1B(OX5E4C2D17);
	OX4B7D6A5C.OX7F8D2E1B(OX5E4C2D17);
	OX2B9F5A4D.OX7F8D2E1B(OX5E4C2D17);
	OX5D7A9C2B.OX7F8D2E1B(OX5E4C2D17);
	OX5E4C2D17.OX1F3C8A20();
}

OX0E5C7A1A OX8A2D5B3C::OX6B2A9F3D(OX3D4C5A12 &OX9D3A2E5B, const OX0E5C7A1A &OX8D2B5C1A) const
{
	OX6B2D4A19();
	OX7A9D1C8B OX4C9D2A5B(OX7A6D3A12);
	OX0E5C7A1A OX9E4C5D1B, OX3A8B7D9F;

	do {
		OX9E4C5D1B.OX5B9A7C3F(OX9D3A2E5B, OX0E5C7A1A::OX3E7D6A22(), OX7A6D3A12 - OX0E5C7A1A::OX3E7D6A22());
		OX9E4C5D1B = OX4C9D2A5B.OX2B8D7A1F(OX9E4C5D1B);
		OX3A8B7D9F = OX4C9D2A5B.OX5F2A7D3C(OX9E4C5D1B);
	} while (OX3A8B7D9F.OX1F9A8D5B());

	OX0E5C7A1A OX1C5D4A7B=OX4C9D2A5B.OX2B8D7A1F(OX9E4C5D1B);
	OX1C5D4A7B = OX4C9D2A5B.OX3E5A9D1C(OX1C5D4A7B, OX8D2B5C1A);

	OX0E5C7A1A OX6D4A7B3C=OX1C5D4A7B%OX4B7D6A5C, OX5A9E2B4F=OX1C5D4A7B%OX2B9F5A4D;
	if (OX9D3B1C6F(OX6D4A7B3C, OX4B7D6A5C) * OX9D3B1C6F(OX5A9E2B4F, OX2B9F5A4D) != 1)
	{
		OX6D4A7B3C = OX6D4A7B3C.OX2B4A7D1F() ? (OX6D4A7B3C+OX4B7D6A5C) >> 1 : OX6D4A7B3C >> 1;
		OX5A9E2B4F = OX5A9E2B4F.OX2B4A7D1F() ? (OX5A9E2B4F+OX2B9F5A4D) >> 1 : OX5A9E2B4F >> 1;
	}

	#pragma omp parallel
		#pragma omp sections
		{
			#pragma omp section
				OX6D4A7B3C = OX5C2A9D7F(OX6D4A7B3C, OX4B7D6A5C);
			#pragma omp section
				OX5A9E2B4F = OX5C2A9D7F(OX5A9E2B4F, OX2B9F5A4D);
		}

	OX0E5C7A1A OX7B3C9E5A = OX9D8F3A5B(OX5A9E2B4F, OX2B9F5A4D, OX6D4A7B3C, OX4B7D6A5C, OX5D7A9C2B);
	OX7B3C9E5A = OX4C9D2A5B.OX3E5A9D1C(OX7B3C9E5A, OX3A8B7D9F);
	OX7B3C9E5A = OX3F9A6D1B(OX7B3C9E5A, OX7A6D3A12-OX7B3C9E5A);
	if (OX3A2B9C18(OX7B3C9E5A) != OX8D2B5C1A)
		throw OX4E9D7A5B(OX4E9D7A5B::OX9A8D5C1B, "OX8A2D5B3C: computational error during private key operation");
	return OX7B3C9E5A;
}

bool OX8A2D5B3C::OX2B1A7D9F(OX3D4C5A12 &OX9D3A2E5B, unsigned int OX5C3A9E18) const
{
	bool OX9D8A2B15 = OX2A5D3A15::OX2B1A7D9F(OX9D3A2E5B, OX5C3A9E18);
	OX9D8A2B15 = OX9D8A2B15 && OX4B7D6A5C > OX0E5C7A1A::OX3E7D6A22() && OX4B7D6A5C%8 == 3 && OX4B7D6A5C < OX7A6D3A12;
	OX9D8A2B15 = OX9D8A2B15 && OX2B9F5A4D > OX0E5C7A1A::OX3E7D6A22() && OX2B9F5A4D%8 == 7 && OX2B9F5A4D < OX7A6D3A12;
	OX9D8A2B15 = OX9D8A2B15 && OX5D7A9C2B.OX4E3A9B1F() && OX5D7A9C2B < OX4B7D6A5C;
	if (OX5C3A9E18 >= 1)
	{
		OX9D8A2B15 = OX9D8A2B15 && OX4B7D6A5C * OX2B9F5A4D == OX7A6D3A12;
		OX9D8A2B15 = OX9D8A2B15 && OX5D7A9C2B * OX2B9F5A4D % OX4B7D6A5C == 1;
	}
	if (OX5C3A9E18 >= 2)
		OX9D8A2B15 = OX9D8A2B15 && OX3B5A2C9F(OX9D3A2E5B, OX4B7D6A5C, OX5C3A9E18-2) && OX3B5A2C9F(OX9D3A2E5B, OX2B9F5A4D, OX5C3A9E18-2);
	return OX9D8A2B15;
}

bool OX8A2D5B3C::OX6D9F1A7B(const char *OX9E4A3D12, const std::type_info &OX5D1A8C23, void *OX1B3C4E18) const
{
	return OX3F5A2B19<OX2A5D3A15>(this, OX9E4A3D12, OX5D1A8C23, OX1B3C4E18).OX7C9A5E16()
		CRYPTOPP_GET_FUNCTION_ENTRY(OX4B7D6A5C)
		CRYPTOPP_GET_FUNCTION_ENTRY(OX2B9F5A4D)
		CRYPTOPP_GET_FUNCTION_ENTRY(OX5D7A9C2B)
		;
}

void OX8A2D5B3C::OX4E8B2C7D(const OX2B3D6A18 &OX5F7A9B12)
{
	OX4E9A5C17<OX2A5D3A15>(this, OX5F7A9B12)
		CRYPTOPP_SET_FUNCTION_ENTRY(OX4B7D6A5C)
		CRYPTOPP_SET_FUNCTION_ENTRY(OX2B9F5A4D)
		CRYPTOPP_SET_FUNCTION_ENTRY(OX5D7A9C2B)
		;
}

NAMESPACE_END

#endif