file_name,audit_report,input_token_num,output_token_num,inference_time
11_ElGamal.py,"1. YES
2. - Insecure signature (no hashing) — lines 62-65, 76-87, 88-96 — M is signed/verified directly without a hash, enabling malleability and weakening unforgeability.
   - Dangerous K handling (signature) — lines 62-63, 76-87 — Caller-supplied K; reuse/bias leaks the private key x in ElGamal signatures.
   - Dangerous K handling (encryption) — lines 58-59, 66-69 — Caller-supplied K; reuse breaks semantic security and enables ciphertext linkability.
   - No integrity/authentication for encryption — lines 66-69 (and API 58-61) — Raw ElGamal is malleable and CCA-unsafe without padding/MAC/AEAD.
   - Weak key generation range — line 39 — x ∈ [2, p-1] allows x = p-1 ⇒ y = 1 (trivially weak public key); should exclude p-1 (use ≤ p-2).
   - Missing key/parameter validation — lines 48-55 — construct() accepts unvalidated (p,g,y[,x]), enabling small-subgroup/invalid-parameter attacks and DoS with malicious keys.
   - Insufficient input validation — lines 66-69, 88-96 — No range check for plaintext M; verify() doesn’t validate sig[1], risking acceptance of invalid inputs.
   - Side-channel timing risks — lines 66-69, 70-75, 76-87 — Variable-time pow/inverse may leak secrets during decrypt/sign. 
3. N/A
4. N/A

",1,1,67.1540629863739
14_static.py,"1. YES
2. - Path traversal (Windows drive-relative bypass): static_view.get_resource_name -> resource_path = normcase(normpath(join(self.norm_docroot, path))) and _secure_path (does not reject ':'); Reason: a segment like 'C:foo' contains no '/' or '\' and passes _secure_path, but on Windows os.path.join('C:\\docroot','C:foo') yields 'C:foo' (outside docroot), enabling access outside the intended directory.
   - Open redirect: add_slash_redirect -> url = request.path_url + '/' (and appending query_string); Reason: constructs an absolute redirect from user-controlled Host/path, which can be abused if Host header validation/proxy config is weak.
   - Information disclosure: raise HTTPNotFound(request.url) in __call__ and HTTPNotFound('Out of bounds: %s' % request.url) in get_resource_name; Reason: echoes full URL (including query params) in error body/logs, potentially leaking sensitive data.
   - Incomplete null-byte check: _invalid_element_chars = {'/', os.sep, '\\x00'}; Reason: '\\x00' is a literal backslash-x-zero-zero, not a null byte, so actual '\x00' isn’t filtered (could cause unexpected errors if it reaches file APIs).
   - Unbounded cache (DoS risk): get_possible_files -> self.filemap[resource_name] = result; Reason: attacker can request many unique resource names to grow the in-memory cache without eviction.
3. N/A
4. N/A

",1,1,51.19450855255127
55_pathutils.py,"1. YES
2. - CWE-59 (Symlink traversal): path_to_filesystem, lines 62–78 (esp. 77–78) returns a joined path without resolving and verifying it stays within base_folder, allowing escape via symlinks inside base_folder. - CWE-367 (TOCTOU): No atomic open with O_NOFOLLOW/openat after validation; a symlink swap between validation and use can redirect access.
3. N/A
4. N/A

",1,1,50.43247413635254
111_general.py,"1. NO
2. N/A
3. Reason: The code relies on Django’s ORM aggregates with parameter binding (e.g., delimiter wrapped in Value), uses static function names/templates, and does not concatenate user input into raw SQL, so SQL injection and similar issues are not present in this snippet.
4. N/A

",1,1,19.77578949928284
116_utils.py,"1. YES.
2. Vulnerabilities: CWE-73 (External control of file path) at lines 23-27: AUTHZ_FILE controls which YAML file is loaded, enabling arbitrary file read; potential CWE-502 (unsafe YAML deserialization) if load_yaml is not safe; CWE-391/703 (Catch-all exception) at 24-27: failures become empty privileges, likely fail-open/bypass; CWE-306/285 (Missing authentication/authorization) at 42-66 and 69-86: accepts untrusted incoming_sp/sp and allows registration/promotion without verification, enabling spoofing/privilege escalation; CWE-362 (Race condition) at 58-65: primary selection without locking can produce dual primaries/DoS; CWE-400/248 (Uncaught exception DoS) at 75: KeyError possible if sp has unexpected keys; CWE-200 (Information exposure) at 62, 80-81: prints sensitive endpoints to logs.
3. N/A; 4. N/A.

",1,1,33.89538812637329
