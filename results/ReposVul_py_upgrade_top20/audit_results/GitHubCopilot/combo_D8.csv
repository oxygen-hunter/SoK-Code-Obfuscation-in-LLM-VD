file_name,audit_report,input_token_num,output_token_num,inference_time
11_ElGamal.py,"1. YES
2. - Malleable encryption / no integrity (IND-CCA insecure): lines 51–63. Reason: raw ElGamal without padding/MAC; ciphertext is multiplicatively malleable and vulnerable to CCA.
   - Insecure signature scheme (no hashing): lines 72–83, 85–93. Reason: signs/verifies raw M instead of H(M), enabling existential forgeries (not EUF‑CMA).
   - Ephemeral K misuse risk (private key leakage if K reused/predictable): lines 51, 55, 60–63, 72–83. Reason: K supplied by caller and not generated/validated; repeated or biased K reveals x.
   - DoS via undefined names/bugs: line 12 (getPrime unqualified), 69 (inverse), 76 (GCD), 86 ('p' instead of self.p), 42–46 (uses built-in 'tuple' not parameter). Reason: runtime exceptions can crash verification/decryption/construct.
   - Wildcard import (namespace pollution): line 1. Reason: increases risk of name shadowing/unexpected behavior.
   - Timing/side-channel exposure: lines 61, 68–69, 78, 88–90. Reason: non-constant-time big-int pow/inverse on secrets (x, K).
   - Keygen progress leakage: lines 9–10, 16–17, 32–33, 35–36. Reason: progress callbacks can leak timing/state information.

",1,1,76.7966456413269
14_static.py,"1) YES
2) Vulnerabilities:
- Symlink traversal (path escape): line “resource_path = normalize_case(normalize_path(combine_path(self.norm_docroot, secured_path)))” and subsequent file access “elif is_there(name): return name”; reason: no realpath check ensures the final path stays within docroot, so a symlink inside docroot can point outside and expose arbitrary files.
- Null-byte handling flaw (potential 500/DoS): line “if any([invalid_char in item for invalid_char in {'/', os.sep, '\\x00'} for item in path_tuple]): return None”; reason: checks for the literal string “\\x00” instead of the NUL byte “\x00”, allowing embedded NUL to reach filesystem calls and raise exceptions.
- Unbounded memory growth (DoS): lines in find_possible_files “cached_result = self.filemap.get(res_name)” and “if not self.reload: self.filemap[res_name] = possible_files”; reason: attacker can trigger unlimited distinct keys to grow self.filemap without eviction.
- DoS bug: line “token = self.tokenize(request, subpath, kw)” in ObscureQueryStringCacheBuster.__call__; reason: base class defines no tokenize method, causing AttributeError on request handling.
- Minor info disclosure: lines “raise HTTP404(request.url)” and “raise HTTP404('Out of bounds: %s' % request.url)”; reason: reflects full user-controlled URL in error detail.
3) n/a
4) n/a

",1,1,54.88936829566956
55_pathutils.py,"1. YES
2. - Symlink traversal/path breakout: in path_to_filesystem at “safe_path = os.path.join(safe_path, part)” and “return safe_path”; no realpath check to ensure the resolved path stays under base_folder, so a symlink inside base_folder can escape to arbitrary locations.
   - Log injection: in path_to_filesystem at log.LOGGER.debug(""Can't translate path safely to filesystem: %s"", path); logs untrusted input, allowing newline/control characters to forge or poison logs (use structured logging or sanitize).
3. N/A
4. N/A

",1,1,52.43344640731812
111_general.py,"1. NO
2. N/A
3. Reason: Aggregates use constant function names and ORM-compiled templates; user inputs (e.g., StringAgg delimiter) are wrapped in Value(), ensuring parameterized SQL and preventing injection; no unsafe I/O, deserialization, or command execution present.
4. N/A

",1,1,22.94130754470825
116_utils.py,"1. YES
2. - Missing authentication/authorization for SP registration/heartbeat/promotion (lines 48-71, 74-89): trusts caller-controlled incoming_sp/sp to create/update/promote service providers without identity or permission checks, enabling spoofing and privilege escalation.
   - DoS via unhandled timestamp parsing (line 41): datetime.fromisoformat on untrusted sp[""last_heartbeat""] can raise ValueError and crash processing, allowing a malicious record to disrupt state updates.
   - Unvalidated inputs forwarded to data layer (potential injection) (lines 50, 66, 75): attacker-controlled fields project and sp_end_point are passed to get_sp_by/get_primary_sp; if the underlying store builds queries unsafely (e.g., SQL), this can lead to injection.
   - Bare except on privilege load (lines 32-35): swallows all errors and returns empty dict, potentially causing fail-open authorization or hiding security misconfigurations.
   - Information disclosure in logs (lines 27, 68, 85-86): prints internal endpoints and role changes to stdout, which may leak sensitive operational details in shared logs.
3. N/A
4. Uncertain: load_yaml (line 33) may be unsafe if it uses yaml.load with an unsafe loader; combined with env-controlled file path (line 31), this could allow arbitrary object deserialization—depends on nvflare.lighter.utils implementation.

",1,1,40.95274877548218
