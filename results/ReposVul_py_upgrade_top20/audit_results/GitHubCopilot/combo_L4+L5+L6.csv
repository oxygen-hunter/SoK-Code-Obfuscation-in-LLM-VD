file_name,audit_report,input_token_num,output_token_num,inference_time
11_ElGamal.py,"1. YES
2. - Broken key generation (generate/recursive_generate): “if number.isPrime(obj.p, …): return recursive_generate()” causes recursion when p is prime, leaving obj.p composite or infinite recursion (DoS); generator selection (recursive_generator) wrongly rejects g where pow(g, q, p)==1 (should require subgroup of order q), allowing weak generators; relies on caller-supplied randfunc/getRandomRange without CSPRNG guarantees. - Insecure encryption (encrypt/_encrypt): raw ElGamal without padding/AEAD and no integrity (malleable, not IND-CCA); K is caller-supplied, so K reuse correlates ciphertexts and can aid attacks. - Insecure signatures (_sign/_verify): signs raw M (no hash), enabling existential forgery; requires caller-supplied K—reuse leaks the private key x; _verify range check uses undefined “p” instead of self.p, breaking validation. - API/validation bugs (construct): uses “tuple” instead of “tup” parameter, causing misuse and potential logic errors.
3. N/A
4. N/A

",1,1,58.33702754974365
14_static.py,"1. YES.
2. Vulnerabilities: Path traversal/docroot escape on Windows due to missing ':' filtering and no post-join docroot check at ""_invalid_element_chars = {'/', os.sep, '\\x00'}"", ""_contains_invalid_element_char"", and ""resource_path = normcase(normpath(join(self.norm_docroot, path)))"" (e.g., a segment like 'C:foo' can escape docroot); Null-byte handling bug at ""_invalid_element_chars = {'/', os.sep, '\\x00'}"" (uses the literal backslash-x-00 string instead of the actual null byte '\x00'), allowing '\x00' to slip through and potentially trigger unexpected filesystem behavior/DoS; Potential open-redirect/host-header poisoning in ""def add_slash_redirect"" where ""url = request.path_url + '/'"" and raw query_string are used, enabling attacker-controlled Location if Host is not validated upstream; Content-type sniffing risk at ""content_type, _ = _guess_type(resource_name)"" used in FileResponse, which can enable XSS when serving user-controlled files unless 'X-Content-Type-Options: nosniff' is set.

",1,1,57.78613257408142
55_pathutils.py,"1. YES

2. Vulnerabilities:
   - Symlink traversal (TOCTOU): lines 61, 68. Reason: The function joins components to base_folder and returns the path without resolving and verifying that the final real path stays within base_folder (e.g., via os.path.realpath + os.path.commonpath), allowing escapes via symlinks.
   - Denial of Service (unbounded recursion): lines 28–35 and 56–63. Reason: Recursive implementations for joining/sanitizing can hit Python’s recursion limit with deeply nested paths, causing RecursionError and service disruption.
   - Windows NTFS Alternate Data Stream (ADS) injection: line 51 (via logic in 39–51). Reason: is_safe_filesystem_path_component permits components containing “:”, enabling paths like ""file.txt:evil"" on Windows, which can create/write hidden ADS streams.

3. N/A

4. N/A

",1,1,47.59238815307617
111_general.py,"1. NO.
3. Reason: These are Django ORM Aggregate wrappers with static function names and ORM-managed SQL rendering; inputs like StringAgg’s delimiter are wrapped in Value() (parameterized), and expressions/orderings are compiled safely by Django, preventing SQL injection or similar issues. No unsafe eval, deserialization, or external I/O is present.

",1,1,19.91316318511963
116_utils.py,"1. YES
2. - Missing authentication/authorization for SP registration/promotion (lines 46-61, 64-74, 76-93): accepts incoming_sp/sp without verification, allowing spoofed registration/promotion to primary; session IDs aren’t bound to identity.
   - Insecure error handling / fail-open (lines 23-26): bare except returns empty dict on privilege load, potentially bypassing authorization and masking critical errors.
   - External control of file path and potential unsafe YAML deserialization (lines 22-24): AUTHZ_FILE can point to attacker-controlled YAML; if load_yaml uses an unsafe loader, this risks code execution and privilege tampering.
   - DoS via unvalidated datetime parsing (line 36): malformed last_heartbeat can raise ValueError and crash; recursion over SP list may cause stack exhaustion on large inputs (lines 32-42).
   - Information disclosure via console logs (lines 16, 67, 87-88): prints internal endpoints/state changes that may leak topology/operations.
   - Race/TOCTOU in primary election/promotion (lines 64-71, 80-91): non-atomic get/update can cause split-brain or unauthorized state flips under concurrency.

",1,1,42.56153869628906
